(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"0ae5":function(e,t,n){e.exports=n.p+"img/hexo-editor-logo.de328791.png"},5022:function(e,t,n){"use strict";var a=n("7102"),i=n.n(a);i.a},7102:function(e,t,n){},"713b":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-layout",{attrs:{view:"lHh Lpr lFf"},on:{contextmenu:function(e){e.preventDefault()}}},[n("q-header",{attrs:{elevated:!e.isLoginPage}},[n("q-toolbar",[n("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu"},on:{click:function(t){e.leftDrawerOpen=!e.leftDrawerOpen}}}),n("q-toolbar-title",[e._v("\n        Hexo Editor\n      ")]),n("hexo-devices"),n("q-btn",{directives:[{name:"show",rawName:"v-show",value:!e.isLoginPage&&-1===e.$route.path.indexOf("settings"),expression:"!isLoginPage&&$route.path.indexOf('settings')===-1"}],attrs:{icon:"settings",flat:"",stretch:"",to:{name:"settings"}}},[n("q-tooltip",{attrs:{"content-style":"font-size: 14px","transition-show":"none","transition-hide":"none",anchor:"bottom middle",self:"center middle"}},[e._v("\n          设置\n        ")])],1),n("q-btn",{directives:[{name:"show",rawName:"v-show",value:!e.isLoginPage&&-1===e.$route.path.indexOf("home"),expression:"!isLoginPage&&$route.path.indexOf('home')===-1"}],attrs:{flat:"",stretch:"",icon:"book",to:{name:"welcome"}}},[n("q-tooltip",{attrs:{"content-style":"font-size: 14px","transition-show":"none","transition-hide":"none",anchor:"bottom middle",self:"center middle"}},[e._v("\n          编辑博客\n        ")])],1),n("q-btn",{directives:[{name:"show",rawName:"v-show",value:!e.isLoginPage,expression:"!isLoginPage"}],attrs:{flat:"",icon:"logout",stretch:""},on:{click:e.onLogout}},[n("q-tooltip",{attrs:{"content-style":"font-size: 14px","transition-show":"none","transition-hide":"none",anchor:"bottom middle",self:"center middle"}},[e._v("\n          退出\n        ")])],1)],1)],1),n("q-drawer",{attrs:{bordered:"",behavior:"mobile","content-class":"bg-grey-1"},model:{value:e.leftDrawerOpen,callback:function(t){e.leftDrawerOpen=t},expression:"leftDrawerOpen"}},[n("app-sidebar")],1),n("q-page-container",[n("router-view")],1)],1)},i=[],r=n("967e"),s=n.n(r),o=(n("96cf"),n("fa84")),c=n.n(o),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit overflow-hidden relative-position"},[a("q-list",{staticClass:"q-pt-xl"},[a("img",{staticClass:"bgimg",attrs:{src:n("0ae5"),alt:"logo"}}),a("div",{staticClass:"absolute fit"}),e._l(e.essentialLinks,(function(t){return a("EssentialLink",e._b({key:t.title},"EssentialLink",t,!1))})),a("q-item",[a("q-item-section",{attrs:{avatar:""}}),a("q-item-section",[a("q-item-label",[e._v("向右拖动文章以编辑")]),a("q-item-label",{attrs:{caption:"",lines:"2"}},[e._v("更多功能请自行探索")])],1)],1),a("q-item",[a("q-item-section",{attrs:{avatar:""}}),a("q-item-section",[a("q-item-label",[a("q-chip",{staticClass:"q-ml-none no-border-radius",staticStyle:{"font-family":"consolas"},attrs:{square:"",size:"10px",color:"primary","text-color":"white"}},[a("q-avatar",{staticClass:"no-border-radius",staticStyle:{width:"auto"},attrs:{color:"grey-8"}},[a("span",{staticStyle:{padding:"0 6px"}},[e._v("\n                winwin-hexo-editor\n              ")])]),a("span",{staticStyle:{"padding-left":"3px"}},[e._v("\n              "+e._s(e.currentVersion)+"\n            ")])],1)],1),a("q-item-label",{attrs:{caption:"",lines:"2"}},[e._v("当前主程序版本")])],1)],1)],2)],1)},u=[],p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-item",{attrs:{clickable:"",tag:"a",target:"_blank",href:e.link}},[e.icon?n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:e.icon}})],1):e._e(),n("q-item-section",[n("q-item-label",[e._v(e._s(e.title))]),n("q-item-label",{attrs:{caption:""}},[e._v("\n      "+e._s(e.caption)+"\n    ")])],1)],1)},d=[],m={name:"EssentialLink",props:{title:{type:String,required:!0},caption:{type:String,default:""},link:{type:String,default:"#"},icon:{type:String,default:""}}},f=m,h=n("2877"),g=n("eebe"),v=n.n(g),w=n("66e5"),b=n("4074"),q=n("0016"),x=n("0170"),k=Object(h["a"])(f,p,d,!1,null,null,null),y=k.exports;v()(k,"components",{QItem:w["a"],QItemSection:b["a"],QIcon:q["a"],QItemLabel:x["a"]});var _=n("365c"),I={name:"AppSidebar",components:{EssentialLink:y},beforeMount:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_["a"].info.version();case 3:t.t0=t.sent,e.currentVersion="v"+t.t0,t.next=10;break;case 7:t.prev=7,t.t1=t["catch"](0),e.currentVersion="获取失败";case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},data:function(){return{currentVersion:"加载中",essentialLinks:[{title:"项目主页",caption:"@winwin",icon:"home",link:"https://winwin_2011.gitee.io/winwin-hexo-editor/"},{title:"获取源码",caption:"@winwin",icon:"code",link:"https://gitee.com/winwin_2011/winwin-hexo-editor"}]}}},L=I,Q=(n("5022"),n("1c1c")),P=n("b047"),A=n("cb32"),S=Object(h["a"])(L,l,u,!1,null,"b3a58338",null),D=S.exports;v()(S,"components",{QList:Q["a"],QItem:w["a"],QItemSection:b["a"],QItemLabel:x["a"],QChip:P["a"],QAvatar:A["a"]});var E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-btn",{attrs:{flat:"",stretch:"",label:e.isLoggedIn?"设备授权":"服务器地址"}},[n("q-menu",{attrs:{fit:!e.isLoggedIn,"content-style":"user-select:none;"+(e.isLoggedIn?"min-width:300px":""),"transition-hide":"none","transition-show":"none",persistent:""},model:{value:e.showPanel,callback:function(t){e.showPanel=t},expression:"showPanel"}},[e.isLoggedIn?[n("q-toolbar",{staticClass:"bg-grey-2",staticStyle:{"min-height":"36px"}},[n("q-icon",{attrs:{name:"devices",size:"sm"}}),n("q-toolbar-title",{staticStyle:{"font-size":"15px"}},[e._v("\n          已授权设备\n        ")]),n("q-btn",{staticClass:"q-mr-xs",attrs:{flat:"",dense:"",icon:"add"},on:{click:e.onAddAPIKEY}}),n("q-btn",{attrs:{flat:"",dense:"",icon:"refresh"},on:{click:e.refreshAPIKEYS}}),n("q-btn",{attrs:{flat:"",dense:"",icon:"close"},on:{click:function(t){e.showPanel=!1}}})],1),n("q-list",[e.apikeys.length?e._e():n("q-item",[n("q-item-section",[n("q-item-label",[e._v("无设备")])],1)],1),e._l(e.apikeys,(function(t){return n("q-item",{key:t.issuedAt},[n("q-item-section",[n("q-item-label",[e._v(e._s(t.deviceType+" / "+t.deviceSystem))]),n("q-item-label",{attrs:{caption:"",lines:"2"}},[e._v("注册时间："+e._s(e.formatDate(t.issuedAt)))]),n("q-item-label",{attrs:{caption:"",lines:"3"}},[e._v("最近登录："+e._s(e.formatDate(t.lastUsedAt)))])],1),n("q-item-section",{attrs:{side:""}},[n("div",{staticClass:"text-grey-8 q-gutter-xs"},[n("q-btn",{staticClass:"gt-xs",attrs:{size:"12px",flat:"",dense:"",icon:"delete"},on:{click:function(n){return e.removeAPIKEY(t._id)}}})],1)])],1)})),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-grey-2",attrs:{clickable:"",dense:""}},[n("q-item-section",[n("q-item-label",[e._v("\n              共 "+e._s(e.apikeys.length)+" 台设备\n            ")])],1)],1)],2)]:n("q-img",{staticClass:"bg-grey-2",attrs:{src:e.qrcode,ratio:1,"spinner-color":"primary"}}),n("q-dialog",{attrs:{persistent:""},model:{value:e.requestApikeyDialog,callback:function(t){e.requestApikeyDialog=t},expression:"requestApikeyDialog"}},[n("q-card",{staticStyle:{"max-width":"300px","min-width":"200px"}},[n("q-toolbar",{staticClass:"bg-grey-2",staticStyle:{"min-height":"36px","user-select":"none"}},[n("q-toolbar-title",{staticStyle:{"font-size":"15px"}},[e._v("\n            使用移动设备扫码登录\n          ")]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:"",icon:"close"}})],1),n("q-img",{staticClass:"bg-grey-2",attrs:{src:e.apikeyImg,ratio:1,"spinner-color":"primary"}})],1)],1)],2)],1)},C=[],Y=n("823b"),O=n("d055");function K(e){return $.apply(this,arguments)}function $(){return $=c()(s.a.mark((function e(t){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",O["toDataURL"](t));case 1:case"end":return e.stop()}}),e)}))),$.apply(this,arguments)}var T=n("bd4c"),z={name:"HexoDevices",data:function(){return{showPanel:!1,qrcode:"",apikeys:[],apikeyToken:"",apikeyImg:"",requestApikeyDialog:!1}},computed:{isLoggedIn:function(){return this.$store.state.user.isLoggedIn}},watch:{showPanel:function(e){e&&this.refreshAPIKEYS()}},methods:{formatDate:function(e){return T["b"].formatDate(new Date(e),"YYYY年M月D日 H:mm")||"无"},onAddAPIKEY:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_["a"].users.requestAPIKEY();case 2:return e.apikeyToken=t.sent,t.next=5,K(JSON.stringify({url:window.location.origin,token:e.apikeyToken}));case 5:e.apikeyImg=t.sent,e.requestApikeyDialog=!0;case 7:case"end":return t.stop()}}),t)})))()},removeAPIKEY:function(e){var t=this;return c()(s.a.mark((function n(){return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,_["a"].users.removeAPIKEY(e);case 2:return n.next=4,t.refreshAPIKEYS();case 4:case"end":return n.stop()}}),n)})))()},refreshAPIKEYS:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isLoggedIn){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,_["a"].users.listAPIKEY();case 5:e.apikeys=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](2),e.apikeys=[];case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))()}},created:function(){var e=this;return c()(s.a.mark((function t(){var n;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new Y["a"]({prefix:"QRCode"}),t.prev=1,n.log(window.location.origin),t.next=5,K(window.location.origin);case 5:e.qrcode=t.sent,t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](1);case 10:case"end":return t.stop()}}),t,null,[[1,8]])})))()},mounted:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.refreshAPIKEYS();case 1:case"end":return t.stop()}}),t)})))()}},H=z,N=n("9c40"),M=n("4e73"),j=n("65c6"),V=n("6ac5"),J=n("068f"),B=n("24e8"),R=n("f09f"),U=n("7f67"),F=Object(h["a"])(H,E,C,!1,null,null,null),G=F.exports;v()(F,"components",{QBtn:N["a"],QMenu:M["a"],QToolbar:j["a"],QIcon:q["a"],QToolbarTitle:V["a"],QList:Q["a"],QItem:w["a"],QItemSection:b["a"],QItemLabel:x["a"],QImg:J["a"],QDialog:B["a"],QCard:R["a"]}),v()(F,"directives",{ClosePopup:U["a"]});var W=n("b09d"),X={name:"MainLayout",components:{AppSidebar:D,HexoDevices:G},data:function(){return{leftDrawerOpen:!1}},computed:{isLoginPage:function(){return"/login"===this.$route.path}},methods:{onLogout:function(){var e=this;return c()(s.a.mark((function t(){var n,a;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,W["a"].create(W["b"].ConfirmDialog,{title:"退出确认",message:"确定要退出么?"});case 2:if(n=t.sent,a=n.type,"ok"!==a){t.next=8;break}return t.next=7,e.$store.dispatch("logout");case 7:e.$router.push("/login");case 8:case"end":return t.stop()}}),t)})))()}}},Z=X,ee=n("4d5a"),te=n("e359"),ne=n("05c0"),ae=n("9404"),ie=n("09e3"),re=Object(h["a"])(Z,a,i,!1,null,null,null);t["default"]=re.exports;v()(re,"components",{QLayout:ee["a"],QHeader:te["a"],QToolbar:j["a"],QBtn:N["a"],QToolbarTitle:V["a"],QTooltip:ne["a"],QDrawer:ae["a"],QPageContainer:ie["a"]})}}]);